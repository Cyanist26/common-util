<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="$!{namespace}">

	<!-- generated by xmd Generator. -->
    <resultMap id="base" type="$!{upperName}DO" extends="$!{basePackage}$!{daoPackage}.base.baseDO">
	    <result column="id" property="id" jdbcType="$!{idJdbcType}" javaType="$!{idType}"/>
#foreach($column in $!{columnList})
#if("$!{column.javaType}" == "String")
        <result column="$!{column.name}" property="$!{column.fieldName}" jdbcType="$!{column.jdbcType}"/>
#elseif("$!{column.javaType}" == "Date")
        <result column="$!{column.name}" property="$!{column.fieldName}" jdbcType="$!{column.jdbcType}" javaType="java.util.Date"/>
#elseif($!{column.haveEnum})
        <result column="$!{column.name}" property="$!{column.fieldName}" jdbcType="$!{column.jdbcType}" javaType="$!{column.javaType}" typeHandler="EnumCodeTypeHandler"/>
#else
        <result column="$!{column.name}" property="$!{column.fieldName}" jdbcType="$!{column.jdbcType}" javaType="$!{column.javaType}"/>
#end
#end
    </resultMap>

	<!-- generated by xmd Generator. -->
    <sql id="allColumn">
        id#foreach($column in $!{columnList}), $!{column.name}#end, is_deleted, create_time, modify_time
    </sql>

	<!-- generated by xmd Generator. -->
    <sql id="whereTest">
        <if test="id != null">AND id = #{id}</if>
#foreach($column in $!{columnList})
        <if test="$!{column.fieldName} != null#if($!{column.javaType} == "String") and $!{column.fieldName} != ''#end">AND $!{column.name} = #{$!{column.fieldName}#if($!{column.haveEnum}), typeHandler=EnumCodeTypeHandler#end}</if>
#end
    </sql>

	<!-- generated by xmd Generator. -->
	<sql id="idCondition">
		is_deleted = 0
		AND id = #{id}
	</sql>

	<!-- generated by xmd Generator. -->
    <insert id="insert" parameterType="$!{upperName}DO">
        INSERT INTO $!{tableName} (id#foreach($column in $!{columnList}), $!{column.name}#end)
        VALUES (#{id, jdbcType=BIGINT}#foreach($column in $!{columnList}), #{$!{column.fieldName}, jdbcType=$!{column.jdbcType}#if($!{column.haveEnum}), javaType=$!{column.javaType}, typeHandler=EnumCodeTypeHandler#end}#end)
    </insert>

	<!-- generated by xmd Generator. -->
    <insert id="insertSelective" parameterType="$!{upperName}DO">
        INSERT INTO $!{tableName}
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
#foreach($column in $!{columnList})
            <if test="$!{column.fieldName} != null">$!{column.name},</if>
#end
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">#{id},</if>
#foreach($column in $!{columnList})
            <if test="$!{column.fieldName} != null">#{$!{column.fieldName}#if($!{column.haveEnum}), typeHandler=EnumCodeTypeHandler#end},</if>
#end
        </trim>
    </insert>

	<!-- generated by xmd Generator. -->
    <update id="update" parameterType="$!{upperName}DO">
        UPDATE $!{tableName} SET
            modify_time = now(),
#foreach($column in $!{columnList})
#if($foreach.hasNext)
            $!{column.name} = #{$!{column.fieldName}, jdbcType=$!{column.jdbcType}#if($!{column.haveEnum}), javaType=$!{column.javaType}, typeHandler=EnumCodeTypeHandler#end},
#else
            $!{column.name} = #{$!{column.fieldName}, jdbcType=$!{column.jdbcType}#if($!{column.haveEnum}), javaType=$!{column.javaType}, typeHandler=EnumCodeTypeHandler#end}
#end
#end
        WHERE id = #{id} AND is_deleted = 0
    </update>

	<!-- generated by xmd Generator. -->
    <update id="updateSelective" parameterType="$!{upperName}DO">
        UPDATE $!{tableName}
        <set>
            modify_time = now(),
#foreach($column in $!{columnList})
            <if test="$!{column.fieldName} != null">$!{column.name} = #{$!{column.fieldName}#if($!{column.haveEnum}), typeHandler=EnumCodeTypeHandler#end},</if>
#end
        </set>
        WHERE id = #{id} AND is_deleted = 0
    </update>

	<!-- generated by xmd Generator. -->
    <delete id="delete" parameterType="$!{idType}">
        UPDATE $!{tableName} SET is_deleted = id, modify_time = now() WHERE id = #{id} AND is_deleted = 0
    </delete>

	<!-- generated by xmd Generator. -->
    <delete id="deleteAll" parameterType="List">
        UPDATE $!{tableName} SET is_deleted = id, modify_time = now() WHERE id IN
        <foreach collection="list" item="id" open="(" separator="," close=")">
            <if test="id != null">#{id}</if>
        </foreach>
        AND is_deleted = 0
    </delete>

	<!-- generated by xmd Generator. -->
    <select id="getById" parameterType="$!{idType}" resultMap="base">
        SELECT <include refid="allColumn"></include>
        FROM $!{tableName}
        WHERE
	    <include refid="idCondition"></include>
    </select>

	<!-- generated by xmd Generator. -->
    <select id="select" parameterType="$!{upperName}DO" resultMap="base">
        SELECT
            <include refid="allColumn"></include>
        FROM $!{tableName}
        <where>
            is_deleted = 0
            <include refid="whereTest"></include>
        </where>
	    <include refid="$!{basePackage}$!{daoPackage}.base.orderBy"></include>
	    <include refid="$!{basePackage}$!{daoPackage}.base.limit"></include>
    </select>

	<!-- generated by xmd Generator. -->
    <select id="count" parameterType="$!{upperName}DO" resultType="int">
        SELECT count(*)
        FROM $!{tableName}
        <where>
            is_deleted = 0
            <include refid="whereTest"></include>
        </where>
    </select>

	<!-- generated by xmd Generator. -->
	<select id="exist" parameterType="$!{idType}" resultType="int">
		SELECT count(*)
		FROM $!{tableName}
		WHERE
		<include refid="idCondition"></include>
	</select>

</mapper>